<!-- Complications -->

<details>
  <summary>
  Complications
  </summary>

<br>

The pre-registration document states . . . 

- *The first-outcome memory tests will be analyzed with a sequence of three McNemar Tests.* **<u>Each test will compare two of the groups and</u> the proportion reporting the extreme option for the high- and low-value option.** *The target prediction of the Encoding Hypothesis is that the proportion of extreme outcomes reported first will be reliably lower in the Extreme First group. Ideally, we would run one test with all three groups (like an overall ANOVA), but as of the time of writing this pre-registration, we have not been able to identify the appropriate variation of a chi-squared test that would work for this scenario.*
  
Based on this, it seems that the plan was to use McNemar Tests for condition comparisons, doing so three times to compare each pair of conditions (E1 vs EL, E1 vs NE, EL vs NE), while also factoring in counts/proportions for the 20th and 80th extremes. It is not clear that there is a way to do that with this test.  You can do one McNemar Test for each condition (which is what has been done below), but you cannot compare across conditions, like is stated in the pre-registration document.

**Alternative to McNemar tests:**

An alternative method to obtain a comparison across conditions could be to run two standard Pearson's Chi-squared tests using a 3 x 2 contingency table for the the High and Low choices respectively, like so...

```{r}
df_h <- data.frame(
  `High Extreme` = c('a','c', 'e'),
  Other = c('b','d','f')
  )

df_l <- data.frame(
  `Low Extreme` = c('a','c', 'e'),
  Other = c('b','d','f')
  )

rownames(df_h) <- c('Extreme First', 'Extreme Last', 'No Extreme')
rownames(df_l) <- c('Extreme First', 'Extreme Last', 'No Extreme')

kable(df_h, 'html') %>%
  kable_classic(full_width = F, position = "left", html_font = "Arial")
```

<br>

```{r}
kable(df_l, 'html') %>%
  kable_classic(full_width = F, position = "left", html_font = "Arial")
```

This would tell you whether reporting the extreme option varied according to condition, and then you could look at the standardized residuals to see where a difference is happening. Or you could do pairwise tests with appropriate p-value adjustments. 

<br>

</details>

<!-- Plot -->

<details>
  <summary>
  Plot - Proportions
  </summary>
  
<br>
  
```{r, out.width = '100%', out.height = '100%'}
source('r-scripts/fo-recall/fo_recall_filter.R')
source('r-scripts/fo-recall/fo_recall_plots.R')

include_graphics(
  file.path(main_dir,"plots/fo-recall/plt_fo_prop.png")
)
```

Note: 

- Proportions are taken within condition and context (high/low). E.g., All the green bars in the top left sum to 1, all the orange bars in the top middle sum to 1, and so on. 
- The colour palette is colourblind friendly.

<br>

</details>

## Pre-Registered Analysis

<!-- McNemar Test with Odds Ratio and Cohen's g effect sizes -->

<details>
  <summary>
    McNemar Test Results
  </summary>
  
```{r}
# source('r-scripts/fo-recall/fo_recall_filter.R')
source('r-scripts/fo-recall/pr_fo_recall_analysis.R')

kable(fo_stats, 'html', digits = 3) %>%
  kable_classic(full_width = T, position = "center", html_font = "Arial") #%>%
  #column_spec(c(4, 6), bold = T)
```

<br>

Effect Size Interpretation

```{r}
kable(interp, 'html', digits = 3) %>%
  kable_classic(full_width = F, position = "left", html_font = "Arial")
```

<br>

Note:

- Report either the odds ratio or Cohen's $g$, not both.
- Almost nobody has heard of Cohen's $g$ and wouldn't know how to interpret it. Furthermore, they would probably confuse it with Hedge's $g$ (which is a variant of Cohen's $d$).  Therefore, it's probably best to report the odds ratio.

<br>

</details>

<!-- McNemar Test Conclusions -->

<details>
  <summary>
    McNemar Test Conclusions
  </summary>

```{r}
chi <- round(fo_stats$Statistic, 2)
df <- round(fo_stats$df)
p <- round(fo_stats$p.value, 3)
OR <- round(fo_stats$OR, 2)
```

<br>

<h4>Extreme First Condition:</h4>

```{r}
kable(g1_tab, 'html') %>%
  kable_classic(full_width = F, position = "left", html_font = "Arial")
```

<br>

$\chi^2(`r df[1]`) = `r chi[1]`, p = `r p[1]`$

- There is a significant change in judgement evaluation between the high and low risky doors.

- The odds of stating the extreme value given they are seeing the high-risk door is `r OR[1]` times that of seeing the low-risk door and not stating the extreme value.

<br>

<h4>Extreme Last Condition:</h4>

```{r}
kable(g2_tab, "html") %>%
  kable_classic(full_width = F, position = "left", html_font = "Arial")
```

<br>

$\chi^2(`r df[2]`) = `r chi[2]`, p = `r p[2]`$

- There is a significant change in judgement evaluation between the high and low risky doors.

- The odds of stating the extreme value given they are seeing the high-risk door is `r OR[2]` times that of seeing the low-risk door and not stating the extreme value.

<br>

<h4>No Extreme Condition:</h4>

```{r}
kable(g3_tab, 'html') %>%
  kable_classic(full_width = F, position = "left", html_font = "Arial")
```

<br>

$\chi^2(`r df[3]`) = `r chi[3]`, p = `r p[3]`$

- There is a significant change in judgement evaluation between the high and low risky doors.

- The odds of stating the extreme value given they are seeing the high-risk door is `r OR[3]` times that of seeing the low-risk door and not stating the extreme value.

<br>

</details>

## Alternative Analysis

<!-- 2x3 Chi-Squared Tests -->

<details>
  <summary>
    2x3 Chi-Squared Tests
  </summary>

```{r}
source('r-scripts/fo-recall/chisq_fo_recall_analysis.R')

chi <- round(c(fo_high_test$statistic, fo_low_test$statistic), 2)
df <- round(c(fo_high_test$parameter, fo_low_test$parameter), 2)
p <- round(c(fo_high_test$p.value, fo_low_test$p.value), 3)
v <- round(c(fo_high_eff, fo_low_eff), 2)
```

<h4> High Value Results </h4>

```{r}
kable(fo_high_tab, 'html', caption = 'High Value Contingency Table') %>%
  kable_classic(full_width = F, position = "left", html_font = "Arial")
```

<br>

$\chi^2(`r df[1]`) = `r chi[1]`, p = `r p[1]`, \varphi_c = `r v[1]`$

- Cannot rule out that recalling the extreme value is independent of condition.


```{r}
kable(std_res_high, 'html', caption = 'Standardized Residuals', digits = 2) %>%
  kable_classic(full_width = F, position = "float_left", html_font = "Arial")

kable(p_high, 'html', caption = 'p-values', digits = 3) %>%
  kable_classic(full_width = F, position = "float_left", html_font = "Arial")
```

<br>
<br>
<br>
<br>
<br>
<br>
<br>

- None of the three conditions differ significantly from the expected value.

<br>


<h4> Low Value Results </h4>

```{r}
kable(fo_low_tab, 'html', caption = 'Low Value Contingency Table') %>%
  kable_classic(full_width = F, position = "left", html_font = "Arial")
```

<br>

$\chi^2(`r df[2]`) = `r chi[2]`, p = `r p[2]`, \varphi_c = `r v[2]`$

- Recalling the extreme value is dependent on condition; however, the association/effect is a weak/small one.


```{r}
kable(std_res_low, 'html', caption = 'Standardized Residuals', digits = 2) %>%
  kable_classic(full_width = F, position = "float_left", html_font = "Arial")

kable(p_low, 'html', caption = 'p-values', digits = 3) %>%
  kable_classic(full_width = F, position = "float_left", html_font = "Arial")
```

<br>
<br>
<br>
<br>
<br>
<br>
<br>

The *No Extreme* and *Extreme 1st* conditions both differ significantly from the expected value. The *No Extreme* condition tends to recall the extreme value, whereas *Extreme 1st* does not.

- No Extreme: $z = `r round(std_res_low[4], 2)`, p = `r round(p_low[4], 3)`$

- Extreme 1st: $z = `r round(std_res_low[5], 2)`, p = `r round(p_low[5], 3)`$

<br>

<h4>Post-Hoc Pairwise Fisher-Exact Tests</h4>

```{r}
kable(fish_tests, 'html', digits = 4) %>%
  kable_classic(full_width = F, position = "left", html_font = "Arial")
```

<br>

- Recalling the extreme value was found to be dependent on condition ($p = `r round(fish_tests$p_value_adj[4], 3)`$) only when low value options in the No Extreme and Extreme First conditions are considered (Row 4 in the table). Everything else fails to reach significance.  

<br>

Note:

- In the contingency tables, 'Yes' indicates the extreme value was recalled, 'No' indicates that it was not.

- Only recalled outcomes that matched the programmed values were included. i.e., if they saw the *High Value Risky Door*, 80 was logged as "Yes" and 60 was logged as "No." If they saw the *Low Value Risky Door*, 20 was logged as "Yes", 40 was logged as "No". Participants who responded with any "other" values were removed from the analysis. Only Risky doors were evaluated. 

- In total, removing "other" responses resulted `r n_other` participants being excluded from these analyses leaving a final N = `r n_fo`.

- $\varphi_c$ is Cramér’s V, a measure of association for two nominal variables (i.e., an effect size of sorts). It can take a value between 0 and 1, with 0 indicating no association (i.e., full independence). 

- Post-hoc analysis on each $\chi^2$ test was conducted by evaluating the standardized residuals from the chi-square analysis because it seemed the most intuitive approach. However, pairwise Pearson Chi-squared or Fisher Exact tests across the three conditions were also run. The `p_value_adj` column shows corrected p-values using the Holm-Bonferroni method.




<br>

</details>
























